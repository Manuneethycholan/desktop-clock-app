{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useState, useEffect, useCallback } from 'react';\nimport { getImagesWithFallback, preloadImages, getNextImage } from '../utils/imageLoader';\n\n/**\n * Custom hook for managing wallpaper rotation\n */\nexport const useWallpaperRotation = (categories, rotationInterval, wallpaperSize, enabled) => {\n  _s();\n  const [availableImages, setAvailableImages] = useState([]);\n  const [currentImage, setCurrentImage] = useState(null);\n  const [currentIndex, setCurrentIndex] = useState(0);\n  const [isLoading, setIsLoading] = useState(true);\n  const [error, setError] = useState(null);\n\n  // Load images for selected categories\n  const loadImages = useCallback(async () => {\n    if (categories.length === 0) {\n      setAvailableImages([]);\n      setCurrentImage(null);\n      setCurrentIndex(0);\n      setIsLoading(false);\n      setError(null);\n      return;\n    }\n    try {\n      setIsLoading(true);\n      setError(null);\n      const {\n        images,\n        errors\n      } = await getImagesWithFallback(categories);\n      if (errors.length > 0) {\n        console.warn('Image loading errors:', errors);\n      }\n      if (images.length === 0) {\n        const errorMessage = errors.length > 0 ? `No valid images found: ${errors.join(', ')}` : 'No images found for selected categories';\n        console.warn(errorMessage);\n        setError(errorMessage);\n        setAvailableImages([]);\n        setCurrentImage(null);\n        setCurrentIndex(0);\n      } else {\n        setAvailableImages(images);\n        setCurrentImage(images[0]);\n        setCurrentIndex(0);\n\n        // Preload images for smooth transitions with error handling\n        try {\n          const validImages = await preloadImages(images.slice(0, 3));\n          if (validImages.length < 3 && validImages.length < images.length) {\n            console.warn('Some images failed to preload, but continuing with available images');\n          }\n        } catch (preloadError) {\n          console.warn('Image preloading failed, but continuing with basic loading:', preloadError);\n        }\n      }\n    } catch (err) {\n      console.error('Error loading wallpaper images:', err);\n      setError(`Failed to load wallpaper images: ${err instanceof Error ? err.message : 'Unknown error'}`);\n      setAvailableImages([]);\n      setCurrentImage(null);\n      setCurrentIndex(0);\n    } finally {\n      setIsLoading(false);\n    }\n  }, [categories]);\n\n  // Move to next image\n  const nextImage = useCallback(() => {\n    if (availableImages.length === 0) return;\n    const {\n      image,\n      nextIndex\n    } = getNextImage(availableImages, currentIndex);\n    setCurrentImage(image);\n    setCurrentIndex(nextIndex);\n\n    // Preload next few images\n    const preloadStart = (nextIndex + 1) % availableImages.length;\n    const imagesToPreload = [];\n    for (let i = 0; i < 2; i++) {\n      const preloadIndex = (preloadStart + i) % availableImages.length;\n      imagesToPreload.push(availableImages[preloadIndex]);\n    }\n    preloadImages(imagesToPreload);\n  }, [availableImages, currentIndex]);\n\n  // Set up rotation interval\n  useEffect(() => {\n    if (!enabled || availableImages.length <= 1) return;\n    const interval = setInterval(nextImage, rotationInterval);\n    return () => clearInterval(interval);\n  }, [enabled, availableImages.length, rotationInterval, nextImage]);\n\n  // Load images when categories change\n  useEffect(() => {\n    loadImages();\n  }, [loadImages]);\n\n  // Get CSS scale value based on wallpaper size\n  const getScaleValue = useCallback(() => {\n    switch (wallpaperSize) {\n      case 'small':\n        return 0.8;\n      case 'large':\n        return 1.2;\n      case 'medium':\n      default:\n        return 1.0;\n    }\n  }, [wallpaperSize]);\n  return {\n    currentImage,\n    availableImages,\n    currentIndex,\n    isLoading,\n    error,\n    nextImage,\n    scaleValue: getScaleValue(),\n    hasImages: availableImages.length > 0\n  };\n};\n_s(useWallpaperRotation, \"BzYwEZm5+Hf1jPli+iVW5GoZKuU=\");","map":{"version":3,"names":["useState","useEffect","useCallback","getImagesWithFallback","preloadImages","getNextImage","useWallpaperRotation","categories","rotationInterval","wallpaperSize","enabled","_s","availableImages","setAvailableImages","currentImage","setCurrentImage","currentIndex","setCurrentIndex","isLoading","setIsLoading","error","setError","loadImages","length","images","errors","console","warn","errorMessage","join","validImages","slice","preloadError","err","Error","message","nextImage","image","nextIndex","preloadStart","imagesToPreload","i","preloadIndex","push","interval","setInterval","clearInterval","getScaleValue","scaleValue","hasImages"],"sources":["/Users/chmanune/Project/Github_wall_paper_project/desktop-clock-app/src/hooks/useWallpaperRotation.ts"],"sourcesContent":["import { useState, useEffect, useCallback } from 'react';\nimport { WallpaperImage, WallpaperSize } from '../types';\nimport { getImagesWithFallback, preloadImages, getNextImage } from '../utils/imageLoader';\n\n/**\n * Custom hook for managing wallpaper rotation\n */\nexport const useWallpaperRotation = (\n  categories: string[],\n  rotationInterval: number,\n  wallpaperSize: WallpaperSize,\n  enabled: boolean\n) => {\n  const [availableImages, setAvailableImages] = useState<WallpaperImage[]>([]);\n  const [currentImage, setCurrentImage] = useState<WallpaperImage | null>(null);\n  const [currentIndex, setCurrentIndex] = useState(0);\n  const [isLoading, setIsLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n\n  // Load images for selected categories\n  const loadImages = useCallback(async () => {\n    if (categories.length === 0) {\n      setAvailableImages([]);\n      setCurrentImage(null);\n      setCurrentIndex(0);\n      setIsLoading(false);\n      setError(null);\n      return;\n    }\n\n    try {\n      setIsLoading(true);\n      setError(null);\n      \n      const { images, errors } = await getImagesWithFallback(categories);\n      \n      if (errors.length > 0) {\n        console.warn('Image loading errors:', errors);\n      }\n      \n      if (images.length === 0) {\n        const errorMessage = errors.length > 0 \n          ? `No valid images found: ${errors.join(', ')}`\n          : 'No images found for selected categories';\n        console.warn(errorMessage);\n        setError(errorMessage);\n        setAvailableImages([]);\n        setCurrentImage(null);\n        setCurrentIndex(0);\n      } else {\n        setAvailableImages(images);\n        setCurrentImage(images[0]);\n        setCurrentIndex(0);\n        \n        // Preload images for smooth transitions with error handling\n        try {\n          const validImages = await preloadImages(images.slice(0, 3));\n          if (validImages.length < 3 && validImages.length < images.length) {\n            console.warn('Some images failed to preload, but continuing with available images');\n          }\n        } catch (preloadError) {\n          console.warn('Image preloading failed, but continuing with basic loading:', preloadError);\n        }\n      }\n    } catch (err) {\n      console.error('Error loading wallpaper images:', err);\n      setError(`Failed to load wallpaper images: ${err instanceof Error ? err.message : 'Unknown error'}`);\n      setAvailableImages([]);\n      setCurrentImage(null);\n      setCurrentIndex(0);\n    } finally {\n      setIsLoading(false);\n    }\n  }, [categories]);\n\n  // Move to next image\n  const nextImage = useCallback(() => {\n    if (availableImages.length === 0) return;\n    \n    const { image, nextIndex } = getNextImage(availableImages, currentIndex);\n    setCurrentImage(image);\n    setCurrentIndex(nextIndex);\n    \n    // Preload next few images\n    const preloadStart = (nextIndex + 1) % availableImages.length;\n    const imagesToPreload = [];\n    for (let i = 0; i < 2; i++) {\n      const preloadIndex = (preloadStart + i) % availableImages.length;\n      imagesToPreload.push(availableImages[preloadIndex]);\n    }\n    preloadImages(imagesToPreload);\n  }, [availableImages, currentIndex]);\n\n  // Set up rotation interval\n  useEffect(() => {\n    if (!enabled || availableImages.length <= 1) return;\n\n    const interval = setInterval(nextImage, rotationInterval);\n    return () => clearInterval(interval);\n  }, [enabled, availableImages.length, rotationInterval, nextImage]);\n\n  // Load images when categories change\n  useEffect(() => {\n    loadImages();\n  }, [loadImages]);\n\n  // Get CSS scale value based on wallpaper size\n  const getScaleValue = useCallback((): number => {\n    switch (wallpaperSize) {\n      case 'small':\n        return 0.8;\n      case 'large':\n        return 1.2;\n      case 'medium':\n      default:\n        return 1.0;\n    }\n  }, [wallpaperSize]);\n\n  return {\n    currentImage,\n    availableImages,\n    currentIndex,\n    isLoading,\n    error,\n    nextImage,\n    scaleValue: getScaleValue(),\n    hasImages: availableImages.length > 0,\n  };\n};"],"mappings":";AAAA,SAASA,QAAQ,EAAEC,SAAS,EAAEC,WAAW,QAAQ,OAAO;AAExD,SAASC,qBAAqB,EAAEC,aAAa,EAAEC,YAAY,QAAQ,sBAAsB;;AAEzF;AACA;AACA;AACA,OAAO,MAAMC,oBAAoB,GAAGA,CAClCC,UAAoB,EACpBC,gBAAwB,EACxBC,aAA4B,EAC5BC,OAAgB,KACb;EAAAC,EAAA;EACH,MAAM,CAACC,eAAe,EAAEC,kBAAkB,CAAC,GAAGb,QAAQ,CAAmB,EAAE,CAAC;EAC5E,MAAM,CAACc,YAAY,EAAEC,eAAe,CAAC,GAAGf,QAAQ,CAAwB,IAAI,CAAC;EAC7E,MAAM,CAACgB,YAAY,EAAEC,eAAe,CAAC,GAAGjB,QAAQ,CAAC,CAAC,CAAC;EACnD,MAAM,CAACkB,SAAS,EAAEC,YAAY,CAAC,GAAGnB,QAAQ,CAAC,IAAI,CAAC;EAChD,MAAM,CAACoB,KAAK,EAAEC,QAAQ,CAAC,GAAGrB,QAAQ,CAAgB,IAAI,CAAC;;EAEvD;EACA,MAAMsB,UAAU,GAAGpB,WAAW,CAAC,YAAY;IACzC,IAAIK,UAAU,CAACgB,MAAM,KAAK,CAAC,EAAE;MAC3BV,kBAAkB,CAAC,EAAE,CAAC;MACtBE,eAAe,CAAC,IAAI,CAAC;MACrBE,eAAe,CAAC,CAAC,CAAC;MAClBE,YAAY,CAAC,KAAK,CAAC;MACnBE,QAAQ,CAAC,IAAI,CAAC;MACd;IACF;IAEA,IAAI;MACFF,YAAY,CAAC,IAAI,CAAC;MAClBE,QAAQ,CAAC,IAAI,CAAC;MAEd,MAAM;QAAEG,MAAM;QAAEC;MAAO,CAAC,GAAG,MAAMtB,qBAAqB,CAACI,UAAU,CAAC;MAElE,IAAIkB,MAAM,CAACF,MAAM,GAAG,CAAC,EAAE;QACrBG,OAAO,CAACC,IAAI,CAAC,uBAAuB,EAAEF,MAAM,CAAC;MAC/C;MAEA,IAAID,MAAM,CAACD,MAAM,KAAK,CAAC,EAAE;QACvB,MAAMK,YAAY,GAAGH,MAAM,CAACF,MAAM,GAAG,CAAC,GAClC,0BAA0BE,MAAM,CAACI,IAAI,CAAC,IAAI,CAAC,EAAE,GAC7C,yCAAyC;QAC7CH,OAAO,CAACC,IAAI,CAACC,YAAY,CAAC;QAC1BP,QAAQ,CAACO,YAAY,CAAC;QACtBf,kBAAkB,CAAC,EAAE,CAAC;QACtBE,eAAe,CAAC,IAAI,CAAC;QACrBE,eAAe,CAAC,CAAC,CAAC;MACpB,CAAC,MAAM;QACLJ,kBAAkB,CAACW,MAAM,CAAC;QAC1BT,eAAe,CAACS,MAAM,CAAC,CAAC,CAAC,CAAC;QAC1BP,eAAe,CAAC,CAAC,CAAC;;QAElB;QACA,IAAI;UACF,MAAMa,WAAW,GAAG,MAAM1B,aAAa,CAACoB,MAAM,CAACO,KAAK,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;UAC3D,IAAID,WAAW,CAACP,MAAM,GAAG,CAAC,IAAIO,WAAW,CAACP,MAAM,GAAGC,MAAM,CAACD,MAAM,EAAE;YAChEG,OAAO,CAACC,IAAI,CAAC,qEAAqE,CAAC;UACrF;QACF,CAAC,CAAC,OAAOK,YAAY,EAAE;UACrBN,OAAO,CAACC,IAAI,CAAC,6DAA6D,EAAEK,YAAY,CAAC;QAC3F;MACF;IACF,CAAC,CAAC,OAAOC,GAAG,EAAE;MACZP,OAAO,CAACN,KAAK,CAAC,iCAAiC,EAAEa,GAAG,CAAC;MACrDZ,QAAQ,CAAC,oCAAoCY,GAAG,YAAYC,KAAK,GAAGD,GAAG,CAACE,OAAO,GAAG,eAAe,EAAE,CAAC;MACpGtB,kBAAkB,CAAC,EAAE,CAAC;MACtBE,eAAe,CAAC,IAAI,CAAC;MACrBE,eAAe,CAAC,CAAC,CAAC;IACpB,CAAC,SAAS;MACRE,YAAY,CAAC,KAAK,CAAC;IACrB;EACF,CAAC,EAAE,CAACZ,UAAU,CAAC,CAAC;;EAEhB;EACA,MAAM6B,SAAS,GAAGlC,WAAW,CAAC,MAAM;IAClC,IAAIU,eAAe,CAACW,MAAM,KAAK,CAAC,EAAE;IAElC,MAAM;MAAEc,KAAK;MAAEC;IAAU,CAAC,GAAGjC,YAAY,CAACO,eAAe,EAAEI,YAAY,CAAC;IACxED,eAAe,CAACsB,KAAK,CAAC;IACtBpB,eAAe,CAACqB,SAAS,CAAC;;IAE1B;IACA,MAAMC,YAAY,GAAG,CAACD,SAAS,GAAG,CAAC,IAAI1B,eAAe,CAACW,MAAM;IAC7D,MAAMiB,eAAe,GAAG,EAAE;IAC1B,KAAK,IAAIC,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAG,CAAC,EAAEA,CAAC,EAAE,EAAE;MAC1B,MAAMC,YAAY,GAAG,CAACH,YAAY,GAAGE,CAAC,IAAI7B,eAAe,CAACW,MAAM;MAChEiB,eAAe,CAACG,IAAI,CAAC/B,eAAe,CAAC8B,YAAY,CAAC,CAAC;IACrD;IACAtC,aAAa,CAACoC,eAAe,CAAC;EAChC,CAAC,EAAE,CAAC5B,eAAe,EAAEI,YAAY,CAAC,CAAC;;EAEnC;EACAf,SAAS,CAAC,MAAM;IACd,IAAI,CAACS,OAAO,IAAIE,eAAe,CAACW,MAAM,IAAI,CAAC,EAAE;IAE7C,MAAMqB,QAAQ,GAAGC,WAAW,CAACT,SAAS,EAAE5B,gBAAgB,CAAC;IACzD,OAAO,MAAMsC,aAAa,CAACF,QAAQ,CAAC;EACtC,CAAC,EAAE,CAAClC,OAAO,EAAEE,eAAe,CAACW,MAAM,EAAEf,gBAAgB,EAAE4B,SAAS,CAAC,CAAC;;EAElE;EACAnC,SAAS,CAAC,MAAM;IACdqB,UAAU,CAAC,CAAC;EACd,CAAC,EAAE,CAACA,UAAU,CAAC,CAAC;;EAEhB;EACA,MAAMyB,aAAa,GAAG7C,WAAW,CAAC,MAAc;IAC9C,QAAQO,aAAa;MACnB,KAAK,OAAO;QACV,OAAO,GAAG;MACZ,KAAK,OAAO;QACV,OAAO,GAAG;MACZ,KAAK,QAAQ;MACb;QACE,OAAO,GAAG;IACd;EACF,CAAC,EAAE,CAACA,aAAa,CAAC,CAAC;EAEnB,OAAO;IACLK,YAAY;IACZF,eAAe;IACfI,YAAY;IACZE,SAAS;IACTE,KAAK;IACLgB,SAAS;IACTY,UAAU,EAAED,aAAa,CAAC,CAAC;IAC3BE,SAAS,EAAErC,eAAe,CAACW,MAAM,GAAG;EACtC,CAAC;AACH,CAAC;AAACZ,EAAA,CA1HWL,oBAAoB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}