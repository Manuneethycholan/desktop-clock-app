{"ast":null,"code":"import{useState,useEffect,useCallback}from'react';import{getImagesForCategories,preloadImages,getNextImage}from'../utils/imageLoader';/**\n * Custom hook for managing wallpaper rotation\n */export const useWallpaperRotation=(categories,rotationInterval,wallpaperSize,enabled)=>{const[availableImages,setAvailableImages]=useState([]);const[currentImage,setCurrentImage]=useState(null);const[currentIndex,setCurrentIndex]=useState(0);const[isLoading,setIsLoading]=useState(true);const[error,setError]=useState(null);// Load images for selected categories\nconst loadImages=useCallback(async()=>{if(categories.length===0){setAvailableImages([]);setCurrentImage(null);setCurrentIndex(0);setIsLoading(false);return;}try{setIsLoading(true);setError(null);const images=await getImagesForCategories(categories);if(images.length===0){console.warn('No images found for selected categories:',categories);setAvailableImages([]);setCurrentImage(null);setCurrentIndex(0);}else{setAvailableImages(images);setCurrentImage(images[0]);setCurrentIndex(0);// Preload images for smooth transitions\npreloadImages(images.slice(0,3));// Preload first 3 images\n}}catch(err){console.error('Error loading wallpaper images:',err);setError('Failed to load wallpaper images');setAvailableImages([]);setCurrentImage(null);}finally{setIsLoading(false);}},[categories]);// Move to next image\nconst nextImage=useCallback(()=>{if(availableImages.length===0)return;const{image,nextIndex}=getNextImage(availableImages,currentIndex);setCurrentImage(image);setCurrentIndex(nextIndex);// Preload next few images\nconst preloadStart=(nextIndex+1)%availableImages.length;const imagesToPreload=[];for(let i=0;i<2;i++){const preloadIndex=(preloadStart+i)%availableImages.length;imagesToPreload.push(availableImages[preloadIndex]);}preloadImages(imagesToPreload);},[availableImages,currentIndex]);// Set up rotation interval\nuseEffect(()=>{if(!enabled||availableImages.length<=1)return;const interval=setInterval(nextImage,rotationInterval);return()=>clearInterval(interval);},[enabled,availableImages.length,rotationInterval,nextImage]);// Load images when categories change\nuseEffect(()=>{loadImages();},[loadImages]);// Get CSS scale value based on wallpaper size\nconst getScaleValue=useCallback(()=>{switch(wallpaperSize){case'small':return 0.8;case'large':return 1.2;case'medium':default:return 1.0;}},[wallpaperSize]);return{currentImage,availableImages,currentIndex,isLoading,error,nextImage,scaleValue:getScaleValue(),hasImages:availableImages.length>0};};","map":{"version":3,"names":["useState","useEffect","useCallback","getImagesForCategories","preloadImages","getNextImage","useWallpaperRotation","categories","rotationInterval","wallpaperSize","enabled","availableImages","setAvailableImages","currentImage","setCurrentImage","currentIndex","setCurrentIndex","isLoading","setIsLoading","error","setError","loadImages","length","images","console","warn","slice","err","nextImage","image","nextIndex","preloadStart","imagesToPreload","i","preloadIndex","push","interval","setInterval","clearInterval","getScaleValue","scaleValue","hasImages"],"sources":["/Users/chmanune/Project/Github_wall_paper_project/desktop-clock-app/src/hooks/useWallpaperRotation.ts"],"sourcesContent":["import { useState, useEffect, useCallback } from 'react';\nimport { WallpaperImage, WallpaperSize } from '../types';\nimport { getImagesForCategories, preloadImages, getNextImage } from '../utils/imageLoader';\n\n/**\n * Custom hook for managing wallpaper rotation\n */\nexport const useWallpaperRotation = (\n  categories: string[],\n  rotationInterval: number,\n  wallpaperSize: WallpaperSize,\n  enabled: boolean\n) => {\n  const [availableImages, setAvailableImages] = useState<WallpaperImage[]>([]);\n  const [currentImage, setCurrentImage] = useState<WallpaperImage | null>(null);\n  const [currentIndex, setCurrentIndex] = useState(0);\n  const [isLoading, setIsLoading] = useState(true);\n  const [error, setError] = useState<string | null>(null);\n\n  // Load images for selected categories\n  const loadImages = useCallback(async () => {\n    if (categories.length === 0) {\n      setAvailableImages([]);\n      setCurrentImage(null);\n      setCurrentIndex(0);\n      setIsLoading(false);\n      return;\n    }\n\n    try {\n      setIsLoading(true);\n      setError(null);\n      \n      const images = await getImagesForCategories(categories);\n      \n      if (images.length === 0) {\n        console.warn('No images found for selected categories:', categories);\n        setAvailableImages([]);\n        setCurrentImage(null);\n        setCurrentIndex(0);\n      } else {\n        setAvailableImages(images);\n        setCurrentImage(images[0]);\n        setCurrentIndex(0);\n        \n        // Preload images for smooth transitions\n        preloadImages(images.slice(0, 3)); // Preload first 3 images\n      }\n    } catch (err) {\n      console.error('Error loading wallpaper images:', err);\n      setError('Failed to load wallpaper images');\n      setAvailableImages([]);\n      setCurrentImage(null);\n    } finally {\n      setIsLoading(false);\n    }\n  }, [categories]);\n\n  // Move to next image\n  const nextImage = useCallback(() => {\n    if (availableImages.length === 0) return;\n    \n    const { image, nextIndex } = getNextImage(availableImages, currentIndex);\n    setCurrentImage(image);\n    setCurrentIndex(nextIndex);\n    \n    // Preload next few images\n    const preloadStart = (nextIndex + 1) % availableImages.length;\n    const imagesToPreload = [];\n    for (let i = 0; i < 2; i++) {\n      const preloadIndex = (preloadStart + i) % availableImages.length;\n      imagesToPreload.push(availableImages[preloadIndex]);\n    }\n    preloadImages(imagesToPreload);\n  }, [availableImages, currentIndex]);\n\n  // Set up rotation interval\n  useEffect(() => {\n    if (!enabled || availableImages.length <= 1) return;\n\n    const interval = setInterval(nextImage, rotationInterval);\n    return () => clearInterval(interval);\n  }, [enabled, availableImages.length, rotationInterval, nextImage]);\n\n  // Load images when categories change\n  useEffect(() => {\n    loadImages();\n  }, [loadImages]);\n\n  // Get CSS scale value based on wallpaper size\n  const getScaleValue = useCallback((): number => {\n    switch (wallpaperSize) {\n      case 'small':\n        return 0.8;\n      case 'large':\n        return 1.2;\n      case 'medium':\n      default:\n        return 1.0;\n    }\n  }, [wallpaperSize]);\n\n  return {\n    currentImage,\n    availableImages,\n    currentIndex,\n    isLoading,\n    error,\n    nextImage,\n    scaleValue: getScaleValue(),\n    hasImages: availableImages.length > 0,\n  };\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}